<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FACTOR - Checkbox Circle</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div style="text-align: center; margin-bottom: 20px;">
            <img src="https://i.postimg.cc/cJkpMPBM/REGLA-20.png" alt="REGLA 20">
        </div>
        <div class="circle-container">
            <svg id="line-svg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></svg>
        </div>
        <div class="controls" style="margin-top: 20px;">
            <label for="viento">Viento:</label>
            <input type="text" id="viento" name="viento">
            <button id="reset-button">Reset</button>
        </div>
        <div id="result-display" style="text-align: center; margin-top: 30px; font-size: 3em; font-weight: bold; color: #333;"></div>
                <div class="bottom-image">
            <img src="https://raw.githubusercontent.com/cobyzero8/kaymi/refs/heads/main/VALORES%20REGLA%2020.png" alt="Valores Regla 20">
        </div>
    </div>
    <script>
        const circleContainer = document.querySelector('.circle-container');
        const vientoInput = document.getElementById('viento');
        const resultDisplay = document.getElementById('result-display');
        const resetButton = document.getElementById('reset-button');
        const numCheckboxes = 32;
        const radius = 130;
        const labelRadius = 155;

        function calculateAndDisplayResult() {
            const selectedCheckbox = circleContainer.querySelector('input[type="checkbox"]:checked');
            const vientoValue = parseFloat(vientoInput.value);

            if (!selectedCheckbox || isNaN(vientoValue) || vientoInput.value.trim() === '') {
                resultDisplay.textContent = '';
                return;
            }

            const checkboxNumber = parseInt(selectedCheckbox.id.replace('cb', ''));
            const checkboxValue = parseFloat(selectedCheckbox.dataset.value);
            let result = checkboxValue * vientoValue;

            const decrementGroup = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18];
            
            if (decrementGroup.includes(checkboxNumber)) {
                result -= 70;
            } else { 
                result += 70;
            }

            resultDisplay.textContent = result.toFixed(2);
        }

        const checkboxValues = {
            1: 0.2, 2: 0.1, 3: 0.1, 4: 0.18, 5: 0.28, 6: 0.45, 7: 0.5, 8: 0.6,
            9: 0.67, 10: 0.65, 11: 0.6, 12: 0.6, 13: 0.6, 14: 0.55, 15: 0.5, 16: 0.25,
            17: 0.2, 18: 0.15, 19: 0.5, 20: 0.15, 21: 0.25, 22: 0.35, 23: 0.5, 24: 0.6,
            25: 0.68, 26: 0.7, 27: 0.7, 28: 0.7, 29: 0.68, 30: 0.6, 31: 0.5, 32: 0.35
        };

        for (let i = 0; i < numCheckboxes; i++) {
            const checkboxNum = i + 1;
            const checkboxValue = checkboxValues[checkboxNum];
            const angle = -Math.PI / 2 - (i / numCheckboxes) * 2 * Math.PI;
            const x_check = Math.cos(angle) * radius;
            const y_check = Math.sin(angle) * radius;

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            const checkId = `cb${checkboxNum}`;
            checkbox.id = checkId;
            checkbox.name = `checkbox-${checkboxNum}`;
            checkbox.dataset.value = checkboxValue;
            checkbox.style.position = 'absolute';
            checkbox.style.left = `calc(50% + ${x_check}px - 7px)`;
            checkbox.style.top = `calc(50% + ${y_check}px - 7px)`;

            checkbox.addEventListener('change', (e) => {
                if (e.target.checked) {
                    const allCheckboxes = circleContainer.querySelectorAll('input[type="checkbox"]');
                    allCheckboxes.forEach(cb => {
                        if (cb !== e.target) {
                            cb.checked = false;
                        }
                    });
                }
                calculateAndDisplayResult();
            });

            const x_label = Math.cos(angle) * labelRadius;
            const y_label = Math.sin(angle) * labelRadius;

            const label = document.createElement('label');
            label.htmlFor = checkId;
            label.textContent = checkboxValue;
            label.style.position = 'absolute';
            label.style.transform = 'translate(-50%, -50%)';
            label.style.left = `calc(50% + ${x_label}px)`;
            label.style.top = `calc(50% + ${y_label}px)`;

            const specialLabels = [1, 5, 9, 13, 17, 21, 25, 29];
            const blueLabels = [2, 19];

            if (specialLabels.includes(checkboxNum)) {
                label.style.color = 'red';
            } else if (blueLabels.includes(checkboxNum)) {
                label.style.color = 'blue';
                label.style.fontWeight = 'bold';
            } else {
                label.style.color = 'black';
                label.style.fontWeight = 'normal';
            }

            circleContainer.appendChild(checkbox);
            circleContainer.appendChild(label);
        }

        vientoInput.addEventListener('input', calculateAndDisplayResult);

        resetButton.addEventListener('click', () => {
            const selectedCheckbox = circleContainer.querySelector('input[type="checkbox"]:checked');
            if (selectedCheckbox) {
                selectedCheckbox.checked = false;
            }
            vientoInput.value = '';
            resultDisplay.textContent = '';
        });

        function drawLine(index1, index2, color = 'black') {
            const svg = document.getElementById('line-svg');
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            const center = 150; // Half of the container's width/height

            const angle1 = -Math.PI / 2 - (index1 / numCheckboxes) * 2 * Math.PI;
            const x1 = center + Math.cos(angle1) * radius;
            const y1 = center + Math.sin(angle1) * radius;

            const angle2 = -Math.PI / 2 - (index2 / numCheckboxes) * 2 * Math.PI;
            const x2 = center + Math.cos(angle2) * radius;
            const y2 = center + Math.sin(angle2) * radius;

            line.setAttribute('x1', x1);
            line.setAttribute('y1', y1);
            line.setAttribute('x2', x2);
            line.setAttribute('y2', y2);
            line.setAttribute('stroke', color);
            line.setAttribute('stroke-width', '2');
            svg.appendChild(line);
        }

        // Draw lines
        drawLine(0, 16); // 1 to 17
        drawLine(4, 20); // 5 to 21
        drawLine(8, 24); // 9 to 25
        drawLine(12, 28); // 13 to 29
    </script>
</body>
</html>
